{"version":3,"sources":["maps_legend_builder.js"],"names":["globalGap","globalFont","globalTextColor","globalCaptionFont","globalCaptionColor","globalBorder","setGlobalValues","textfont","textcolor","gap","captionfont","captioncolor","borderstyle","tablesInit","columns","rows","id","body","document","getElementById","j","tbl","createElement","style","border","align","i","tr","insertRow","td","insertCell","appendChild","splitCell","col","row","cols_amount","createInternalTable","createTable","cols","is_split","extrenalcol","externalrow","inside_col","tdID","undefined","getCell","table","r","c","cell","cells","insertCanvas","canv","layeredColoring","column","colors","strokecolor","size","is_vertical","description","txtGap","xgap","ygap","caption","canvasSize","getWH","length","mytable","ctx","getCtx","w","h","x0","y0","x","y","fillStyle","fillRect","strokeStyle","strokeRect","startCoord","dCoord","constCoordDescr","coordDescr","alert","textDrawing","setCaption","drawRings","color","Array","isArray","beginPath","arc","Math","PI","curcolor","fill","closePath","tst","black","getSizeArray","arr","slice","max","apply","setText","textwidth","mycell","getTextWidth","width","currentfont","font","innerHTML","height","getContext","circles","currentsize","maxR","sizeArray","currentcolor","cursize","text","cap","createCaption","drawText","textAlign","textBaseline","fillText","dx","dy","slices","fillcolors","strokecolors","internaltext","internaltextfont","internaltextcolor","tablerow","tablecol","canvL","canvW","xtext","ytext","drawDottedLine","linecolor","pattern","lineWidth","lastX","moveTo","k","lineTo","stroke","drawArrow","arrowwidth","arrowcolor","linesLegend","ctxW","arrH","ctxH","l","arrowY","pointsMethod","diameter","rows_amount","drawPoints","radius","textLegend","descr","descrfont","descrcolor","imagesLegend","links","img","src","amount"],"mappings":"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","file":"maps_legend_builder.b0a857a3.js","sourceRoot":"..","sourcesContent":["﻿var globalGap = 5;\r\nvar globalFont = \"10pt Arial\";\r\nvar globalTextColor = \"black\";\r\nvar globalCaptionFont = \"12pt Arial\";\r\nvar globalCaptionColor = \"black\";\r\nvar globalBorder = \"\"; //'1px solid black'; //\"\"; //\"5px solid rgba(0,0,0,0)\"; //'1px solid black'; //\"\"\r\n\r\nfunction setGlobalValues(textfont, textcolor, gap, captionfont, captioncolor, borderstyle) {\r\n    globalFont = textfont || globalFont;\r\n    globalTextColor = textcolor || globalTextColor;\r\n    globalGap = gap || globalGap;\r\n    globalCaptionFont = captionfont || globalCaptionFont;\r\n    globalCaptionColor = captioncolor || globalCaptionColor;\r\n    globalBorder = borderstyle || globalBorder;\r\n}\r\n\r\nfunction tablesInit(columns, rows, id){\r\n    //rows - array of rows number of every table\r\n    var body = document.getElementById(id); //document.body,\r\n    \r\n    for (j = 0; j < columns; j++) {\r\n        var tbl  = document.createElement('table');\r\n\r\n        //it is nessesary not to have table for all screen\r\n        tbl.style =\"table-layout:fixed;\"\r\n        tbl.style.border = globalBorder;\r\n        tbl.align = \"left\";\r\n\r\n        for(var i = 0; i < rows[j]; i++) {\r\n            var tr = tbl.insertRow();\r\n            var td = tr.insertCell();\r\n            td.id = \"td\" + j + i;\r\n            td.style.border = globalBorder;\r\n        }\r\n        body.appendChild(tbl);\r\n    }\r\n}\r\n\r\nfunction splitCell(col, row, cols_amount) {\r\n    //always 1 row \r\n    cols_amount = cols_amount || 2;\r\n    createInternalTable(col, row, 1, cols_amount, true);\r\n}\r\n\r\nfunction createTable(id, rows, cols, is_split, align) {\r\n    var body = document.getElementById(id);\r\n    var tbl  = document.createElement('table');\r\n\r\n    //it is nessesary not to have table for all screen\r\n    tbl.style=\"table-layout:fixed;\"\r\n    tbl.style.border = globalBorder;\r\n    var cols = cols || 2;\r\n    for (j = 0; j < rows; j++) {\r\n        var tr = tbl.insertRow();\r\n        for(var i = 0; i < cols; i++) {            \r\n            var td = tr.insertCell();\r\n            if (is_split) {\r\n                td.id = id + i;\r\n                td.style = \"vertical-align: top;\"; //to have table in top of the cell\r\n            } else {\r\n                td.style = \"vertical-align: center;\"; //to have text in cell in center\r\n                if (align) {\r\n                    td.align = align;\r\n                }\r\n            }\r\n            td.style.border = globalBorder;\r\n        }\r\n    }\r\n    body.appendChild(tbl);\r\n    return tbl;\r\n}\r\n\r\nfunction createInternalTable(extrenalcol, externalrow, rows, cols, is_split, inside_col, align) {\r\n    var tdID = \"td\" + extrenalcol + externalrow;\r\n    if ((inside_col != undefined) && (inside_col !== false)) {\r\n        tdID = tdID + inside_col;\r\n    }\r\n    var tbl = createTable(tdID, rows, cols, is_split, align); //tableCreate(cols, rows, tdID);\r\n    return tbl;\r\n}\r\n\r\nfunction getCell(table, r, c) {  \r\n    var cell = table.rows[r].cells;      \r\n    return cell[c];\r\n } \r\n\r\nfunction insertCanvas(td) {\r\n    var canv = document.createElement('canvas');\r\n    td.appendChild(canv);\r\n    return canv;\r\n}\r\n\r\n//rectangles (изолинейная шкала)\r\nfunction layeredColoring(column, row, colors, strokecolor, size, is_vertical, description, textfont, textcolor, txtGap, xgap, ygap, caption, captionfont, captioncolor, inside_col) {\r\n\r\n    xgap = xgap || globalGap;\r\n    ygap = ygap || globalGap;\r\n    canvasSize = getWH(colors.length, size, is_vertical);\r\n    var mytable = createInternalTable(column, row, 1, 1, false, inside_col);\r\n    var ctx = getCtx(mytable, 0, 0, canvasSize.w + xgap*2, canvasSize.h + ygap*2);\r\n\r\n    var x0 = xgap; \r\n    var y0 = ygap;\r\n    var x = x0;\r\n    var y = y0;\r\n    var w = size[0];\r\n    var h = size[1];\r\n      \r\n    // rectangles drawing\r\n    for (i = 0; i < colors.length; i++) {\r\n        ctx.fillStyle = colors[i];\r\n        ctx.fillRect(x, y, w, h);\r\n        ctx.strokeStyle = strokecolor || \"grey\";\r\n        ctx.strokeRect(x, y, w, h);\r\n        if (!is_vertical) {\r\n            x = x + w;\r\n        }\r\n        else {\r\n            y = y + h;\r\n        }\r\n    }\r\n\r\n    //text drawing\r\n    var startCoord, dCoord, constCoordDescr, coordDescr;\r\n    if (is_vertical) {\r\n        startCoord = y0;\r\n        dCoord = h;\r\n        txtGap = txtGap || w + w*0.1\r\n        constCoordDescr = x0 + txtGap;            \r\n    }\r\n    else {\r\n        startCoord = x0;\r\n        dCoord = w;\r\n        txtGap = txtGap || h + h*0.7\r\n        constCoordDescr = y0 + txtGap;\r\n    } \r\n\r\n    //start coordinate\r\n    switch(description.length) {\r\n        case colors.length - 1: \r\n            coordDescr = startCoord + dCoord;    \r\n            break;\r\n        case colors.length + 1:\r\n            coordDescr = startCoord;    \r\n            break;\r\n        case colors.length:\r\n            coordDescr = startCoord + dCoord/2.0;\r\n            break;\r\n        default:\r\n            alert('Incorrect');\r\n    }\r\n\r\n    if (is_vertical) {\r\n        textDrawing(ctx, constCoordDescr, coordDescr, 0, dCoord, \"start\", description, textfont, textcolor);\r\n    }\r\n    else {\r\n        textDrawing(ctx, coordDescr, constCoordDescr, dCoord, 0, \"center\", description, textfont, textcolor);  \r\n    }\r\n\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction drawRings(ctx, x, y, size, color) {\r\n    if (Array.isArray(size)) {\r\n        for (j = 0; j < size.length; j++) {\r\n            ctx.beginPath();\r\n            ctx.arc(x, y, size[j], 0, Math.PI*2);\r\n            var curcolor = (Array.isArray(color)? color[j] : color || \"black\")\r\n            ctx.fillStyle = curcolor;\r\n            ctx.fill();   \r\n            ctx.closePath();\r\n        }\r\n    }\r\n    else {\r\n        ctx.beginPath();\r\n        ctx.arc(x, y, size, 0, Math.PI*2);\r\n        var tst = color[j] || color || black;\r\n        ctx.fillStyle = (Array.isArray(color)? color[j] : color || \"black\"); \r\n        ctx.fill();         \r\n        ctx.closePath();\r\n    }      \r\n}\r\n\r\nfunction getSizeArray(size) {\r\n    var arr = size.slice();\r\n    for (i = 0; i < arr.length; i++) {\r\n        if (arr[i].length != undefined) {\r\n            arr[i] = Math.max.apply(null, arr[i]);        \r\n        }\r\n    }\r\n    return arr;\r\n}\r\n\r\nfunction setText(mytable, r, c, description, textfont, textcolor, textwidth) {\r\n    var mycell = getCell(mytable, r, c);\r\n    if (textwidth != undefined) {\r\n        var w = getTextWidth(description);\r\n        mycell.width = textwidth || w || \"100px\";\r\n    }\r\n    var currentfont = Array.isArray(textfont) ? textfont[i] : textfont;\r\n    mycell.style.font = currentfont || globalFont; \r\n    mycell.style.color = textcolor || globalTextColor;\r\n    mycell.innerHTML = description;\r\n}\r\n\r\nfunction getCtx(mytable, i, column, w, h) {\r\n    var mycell = getCell(mytable, i, column);\r\n    var canv = insertCanvas (mycell);\r\n    canv.width = w; \r\n    canv.height = h;\r\n    var ctx = canv.getContext('2d');\r\n    return ctx;\r\n} \r\n\r\n//значки и картодиаграммы\r\nfunction circles(column, row, size, is_vertical, color, description, textfont, textcolor, textwidth, caption, captionfont, captioncolor, inside_col) {\r\n    //column & row - coordinates of cell of external table, where will be our circles\r\n    //inside_col is a column number of internal table in the external table\r\n    //create internal table with description.length rows\r\n    // if there is only one color - set it in one array: \"yellow\"\r\n    // if there only one size with difficult structure: [[...]]\r\n    if (is_vertical) {\r\n        var mytable = createInternalTable(column, row, description.length, 2, false, inside_col);\r\n    } else {\r\n        var mytable = createInternalTable(column, row, 2, description.length, false, inside_col, \"center\");    \r\n    }\r\n    \r\n    var currentsize;\r\n    var maxR;\r\n    if (Array.isArray(size)) {\r\n        var sizeArray = getSizeArray(size);  \r\n        maxR = Math.max.apply(null, sizeArray); \r\n        if ((size.length == 1) && (Array.isArray(size[0]))) {\r\n            currentsize = size[0];\r\n        } \r\n    } else {\r\n        currentsize = size;\r\n        maxR = size;\r\n    }\r\n    \r\n    //coordinate of circles center\r\n    var x0 = maxR + globalGap; \r\n\r\n    //if there is a only one color for all \r\n    var currentcolor;\r\n    if (Array.isArray(color)) {\r\n        if (color.length == 1) {\r\n            currentcolor = color[0];\r\n        }\r\n    } else {\r\n        currentcolor = color;\r\n    }\r\n\r\n    if (Array.isArray(description)) {\r\n        for (i = 0; i < description.length; i++) {       \r\n            if (is_vertical) {\r\n                var ctx = getCtx(mytable, i, 0, x0*2, x0*2);\r\n                setText(mytable, i, 1, description[i], textfont, textcolor, textwidth);\r\n            } else {\r\n                var ctx = getCtx(mytable, 0, i, x0*2, x0*2);\r\n                setText(mytable, 1, i, description[i], textfont, textcolor, textwidth);\r\n            }\r\n            \r\n            ctx.beginPath();\r\n            if (currentcolor) {\r\n                color[i] = currentcolor;    \r\n            }\r\n            var curcolor = currentcolor ? currentcolor : color[i];\r\n            var cursize = currentsize || size[i];\r\n            drawRings(ctx, x0, x0, cursize, curcolor);\r\n            ctx.closePath(); \r\n        }\r\n    }\r\n    else {\r\n        var ctx = getCtx(mytable, 0, 0, x0*2, x0*2);\r\n        drawRings(ctx, x0, x0, size, currentcolor);\r\n        setText(mytable, 0, 1, description, textfont, textcolor, textwidth);\r\n    }\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction setCaption(mytable, font, color, text) {\r\n    if (text) {\r\n        var cap = mytable.createCaption();\r\n        cap.style.font = font || globalCaptionFont || globalFont; \r\n        cap.style.color = color || globalCaptionColor || globalTextColor;\r\n        cap.innerHTML = text;\r\n    }\r\n}\r\n\r\nfunction drawText(ctx, x, y, align, description, currentfont, textcolor) {\r\n    ctx.fillStyle = textcolor || globalTextColor;\r\n    ctx.font = currentfont || globalFont; \r\n    ctx.textAlign = align;\r\n    ctx.textBaseline = \"middle\";\r\n    ctx.fillText(description, x, y);\r\n}\r\n\r\nfunction textDrawing(ctx, x, y, dx, dy, align, description, textfont, textcolor) {\r\n    for (i = 0; i < description.length; i ++) {\r\n        var currentfont = Array.isArray(textfont) ? textfont[i] : textfont;\r\n        drawText(ctx, x, y, align, description[i], currentfont, textcolor);\r\n        x = x + dx;\r\n        y = y + dy;\r\n    }\r\n}\r\n\r\nfunction slices(col, row, size, fillcolors, strokecolors, is_vertical, description, textfont, textcolor, internaltext, internaltextfont, internaltextcolor, textwidth, caption, captionfont, captioncolor, inside_col) {\r\n    //size[0] - length - w, size[1] - h\r\n\r\n    var tablerow = is_vertical? description.length : 2;\r\n    var tablecol = is_vertical? 2 : description.length;\r\n    if (is_vertical) {\r\n        var mytable = createInternalTable(col, row, tablerow, tablecol, false, inside_col); \r\n    } else {\r\n        var mytable = createInternalTable(col, row, tablerow, tablecol, false, inside_col, \"center\"); \r\n    }\r\n                \r\n    var w = size[0];\r\n    var h = size[1];\r\n\r\n    var x = globalGap; \r\n       \r\n    canvL = w + globalGap;\r\n    canvW = h + globalGap;\r\n\r\n    // rectangles drawing\r\n    for (i = 0; i < fillcolors.length; i++) {\r\n        var ctx;\r\n        if (is_vertical) {\r\n            ctx = getCtx(mytable, i, 0, canvL, canvW);\r\n        } else {\r\n            ctx = getCtx(mytable, 0, i, canvL, canvW);\r\n        }\r\n\r\n        ctx.fillStyle = fillcolors[i];\r\n        ctx.fillRect(x, x, w, h);\r\n        ctx.strokeStyle = strokecolors;\r\n        ctx.strokeRect(x, x, w, h);\r\n\r\n        //text inside the rectangle\r\n        if (internaltext != undefined) {\r\n            if (internaltext[i] != undefined) {\r\n                xtext = x + (w/2.0);\r\n                ytext = x + (h/2.0);\r\n                drawText(ctx, xtext, ytext, \"center\", internaltext[i], internaltextfont, internaltextcolor);\r\n            }\r\n        }\r\n\r\n        if (is_vertical) {\r\n            setText(mytable, i, 1, description[i], textfont, textcolor, textwidth);\r\n        } else {\r\n            setText(mytable, 1, i, description[i], textfont, textcolor, textwidth);\r\n        }  \r\n    }    \r\n\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction drawDottedLine(ctx, length, x, y, width, linecolor, pattern) {\r\n    if (pattern.length != undefined) {\r\n        ctx.beginPath();\r\n        ctx.lineWidth = width;\r\n        ctx.strokeStyle = linecolor;\r\n        var lastX = x + length;\r\n        ctx.moveTo(x, y);\r\n        while (x < lastX) {\r\n            for (k = 0; k < pattern.length; k+=2) {\r\n                x = x + pattern[k];\r\n                if (x > lastX) {\r\n                    x = lastX;\r\n                    ctx.lineTo(x, y);      \r\n                    break;\r\n                }\r\n                ctx.lineTo(x, y);      \r\n                x = x + pattern[k+1];\r\n                ctx.moveTo(x, y);\r\n            } \r\n        };        \r\n        ctx.stroke();\r\n    }\r\n}\r\n\r\nfunction drawArrow(ctx, x, y, arrowwidth, arrowcolor) {\r\n    ctx.beginPath();\r\n    ctx.fillStyle = arrowcolor;\r\n    ctx.moveTo(x, y + arrowwidth/2.0);\r\n    ctx.lineTo(x, y - arrowwidth/2.0);\r\n    x = x + arrowwidth;\r\n    ctx.lineTo(x, y);\r\n    ctx.fill();    \r\n}\r\n\r\nfunction linesLegend(col, row, length, width, colors, pattern, description, arrowwidth, textfont, textcolor, textwidth, caption, captionfont, captioncolor, inside_col) {\r\n    // width, colors, pattern - can be array of array: [5, [4,3,2], 1]\r\n    // pattern can be false\r\n    // arrowwidth - array\r\n    var mytable = createInternalTable(col, row, description.length, 2, false, inside_col); \r\n\r\n    //if one color for all lines\r\n    if ((!Array.isArray(colors) && (Array.isArray(description))) || (Array.isArray(colors) && (colors.length != description.length))) {\r\n        colors = new Array(description.length).fill(colors);\r\n    }\r\n\r\n    //if one width for all lines\r\n    if ((!Array.isArray(width) && (Array.isArray(description))) || (Array.isArray(width) && (width.length != description.length))) {\r\n        width = new Array(description.length).fill(width);\r\n    }\r\n\r\n    //if one arrowwidth for all lines\r\n    if ((!Array.isArray(arrowwidth) && (Array.isArray(description))) || (Array.isArray(arrowwidth) && (arrowwidth.length != description.length))) {\r\n        arrowwidth = new Array(description.length).fill(arrowwidth);\r\n    }\r\n\r\n    arrowwidth = arrowwidth || false;\r\n\r\n    var x0 = globalGap;\r\n    var y0 = globalGap + 2; \r\n    var x = x0;\r\n    var y = y0;\r\n    var ctxW = length + globalGap * 2;\r\n    var arrH = getSizeArray(width);\r\n    var ctxH = Math.max.apply(null, arrH) + globalGap * 2;\r\n    for (i = 0; i < description.length; i++) { //array amount\r\n        ctx = getCtx(mytable, i, 0, ctxW, ctxH);\r\n        var l = length;\r\n        x = x0;\r\n        if (arrowwidth) { //not false not undefined\r\n            if (arrowwidth[i]) {\r\n                if (arrowwidth[i] < 0) {\r\n                    x = x0 - arrowwidth[i];\r\n                    l = length + arrowwidth[i]; //arrowwidth < 0 => line will be shorter\r\n                }\r\n                else if (arrowwidth[i] > 0) { //arrowwidth > 0 => line will be shorter\r\n                    l = length - arrowwidth[i];\r\n                }\r\n            }\r\n        }\r\n        if (Array.isArray(width[i])) {\r\n            for (j = 0; j < colors[i].length; j++) { //lines amount inside the line\r\n                if (pattern[i] && pattern[i][j]) {\r\n                    drawDottedLine(ctx, l, x, y + width[i][0] / 2.0, width[i][j], colors[i][j], pattern[i][j]); \r\n                } else {\r\n                    ctx.beginPath();\r\n                    ctx.strokeStyle = colors[i][j];\r\n                    ctx.lineWidth = width[i][j];\r\n                    ctx.moveTo(x, y + width[i][0] / 2.0);\r\n                    ctx.lineTo(x + l, y + width[i][0] / 2.0);\r\n                    ctx.stroke()\r\n                }\r\n            }\r\n        } else {\r\n            if (pattern[i]) {\r\n                drawDottedLine(ctx, l, x, y + width[i] / 2.0, width[i], colors[i], pattern[i]);\r\n            } else {\r\n                ctx.beginPath();\r\n                ctx.strokeStyle = colors[i];\r\n                ctx.lineWidth = width[i];\r\n                ctx.moveTo(x, y + width[i] / 2.0);\r\n                ctx.lineTo(x + l, y + width[i] / 2.0);\r\n                ctx.stroke();\r\n            }\r\n        }\r\n\r\n        if (arrowwidth) {\r\n            if (arrowwidth[i]) {\r\n                arrowcolor = Array.isArray(colors[i]) ? colors[i][0] : colors[i];\r\n                arrowY = Array.isArray(width[i]) ? width[i][0] / 2.0 + y : width[i] / 2.0 + y;\r\n                w = arrowwidth[i];\r\n                if (w < 0) {\r\n                    drawArrow(ctx, x, arrowY, w, arrowcolor);\r\n                }\r\n                else {\r\n                    drawArrow(ctx, x + l, arrowY, w, arrowcolor);\r\n                }\r\n            }\r\n        }\r\n        setText(mytable, i, 1, description[i], textfont, textcolor, textwidth);\r\n    }\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction pointsMethod(col, row, is_vertical, diameter, color, description, strokecolor, textfont, textcolor, caption, captionfont, captioncolor, inside_col) {\r\n    //arrays\r\n    //always 3 circless\r\n    var rows_amount = Array.isArray(description)? description.length : 1;\r\n    if (is_vertical) {\r\n        var mytable = createInternalTable(col, row, rows_amount, 2, false, inside_col); //, description.length);\r\n    } else {\r\n        var mytable = createInternalTable(col, row, 1, 2*rows_amount, false, inside_col, \"center\"); //, description.length);\r\n    }\r\n    \r\n    if (rows_amount == 1) {\r\n        var gap = globalGap > diameter? globalGap : diameter;\r\n        var w = gap + diameter*3;\r\n        var h = gap + 5*diameter/2.0;\r\n        var ctx = getCtx(mytable, 0, 0, w, h);\r\n        drawPoints(ctx, diameter/2.0, color, description, strokecolor);\r\n        setText(mytable, 0, 1, description, textfont, textcolor);\r\n    } else {\r\n        for (i = 0; i < rows_amount; i++) {\r\n            var gap = globalGap > diameter[i]? globalGap : diameter[i];\r\n            var w = gap + diameter[i]*3;\r\n            var h = gap + 5*diameter[i]/2.0;\r\n            if (is_vertical) {\r\n                var ctx = getCtx(mytable, i, 0, w, h);\r\n                setText(mytable, i, 1, description[i], textfont, textcolor);\r\n            } else {\r\n                var ctx = getCtx(mytable, 0, 2*i, w, h);\r\n                setText(mytable, 0, 2*i + 1, description[i], textfont, textcolor);\r\n            }\r\n            drawPoints(ctx, diameter[i]/2.0, color[i], strokecolor);\r\n        }\r\n    }  \r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction drawPoints(ctx, radius, color, strokecolor) {\r\n    var x0 = radius*2; \r\n    var y0 = x0;\r\n    var x = x0;\r\n    var y = y0;\r\n    ctx.strokeStyle = strokecolor || color;\r\n    ctx.fillStyle = color || black;\r\n\r\n    ctx.beginPath(); //first point\r\n    ctx.arc(x, y, radius, 0, Math.PI*2);    \r\n    ctx.stroke();\r\n    ctx.fill();         \r\n    ctx.closePath();\r\n\r\n    ctx.beginPath(); //second point\r\n    ctx.arc(x + 4*radius, y, radius, 0, Math.PI*2);\r\n    ctx.stroke();\r\n    ctx.fill();         \r\n    ctx.closePath();\r\n\r\n    ctx.beginPath(); //thirs point\r\n    ctx.arc(x + 2*radius, y + 3*radius, radius, 0, Math.PI*2);\r\n    ctx.stroke();\r\n    ctx.fill();         \r\n    ctx.closePath();\r\n}\r\n\r\nfunction textLegend(col, row, text, textfont, textcolor, descr, descrfont, descrcolor, caption, captionfont, captioncolor, inside_col) {\r\n    var rows_amount = Array.isArray(descr)? descr.length : 1;\r\n    var mytable = createInternalTable(col, row, rows_amount, 2, false, inside_col); //, description.length);\r\n\r\n    //if one color for all text elements\r\n    if ((!Array.isArray(textcolor) && (Array.isArray(descr))) || (Array.isArray(textcolor) && (textcolor.length != descr.length))) {\r\n        textcolor = new Array(descr.length).fill(textcolor);\r\n    }\r\n    \r\n    if (rows_amount == 1) {\r\n        setText(mytable, 0, 0, text, textfont, textcolor);\r\n        setText(mytable, 0, 1, descr, descrfont, descrcolor);\r\n    } else {\r\n        for (i = 0; i < rows_amount; i++) {\r\n            var font = textfont? textfont[i] : false;\r\n            var color = textcolor? textcolor[i] : false;\r\n            setText(mytable, i, 0, text[i], textfont[i], textcolor[i]);\r\n            setText(mytable, i, 1, descr[i], descrfont[i], descrcolor[i]);\r\n        }\r\n    }\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction imagesLegend(col, row, links, descr, descrfont, descrcolor, caption, captionfont, captioncolor, inside_col) {\r\n    var rows_amount = Array.isArray(descr)? descr.length : 1;\r\n    var mytable = createInternalTable(col, row, rows_amount, 2, false, inside_col); \r\n    if (rows_amount == 1) {\r\n        var mycell = getCell(mytable, 0, 0);\r\n        var img = document.createElement(\"img\");    \r\n        mycell.appendChild(img);\r\n        img.src = links;    \r\n        setText(mytable, 0, 1, descr, descrfont, descrcolor);\r\n    } else {\r\n        for (i = 0; i < rows_amount; i++) {\r\n            var mycell = getCell(mytable, i, 0);\r\n            var img = document.createElement(\"img\");    \r\n            mycell.appendChild(img);\r\n            img.src = links[i];\r\n            var font = descrfont? descrfont[i] : false;\r\n            var color = descrcolor? descrcolor[i] : false;\r\n            setText(mytable, i, 1, descr[i], font, color);\r\n        }\r\n    }\r\n    setCaption(mytable, captionfont, captioncolor, caption);\r\n}\r\n\r\nfunction getWH(amount, size, is_vertical, gap, description) {\r\n    // for layeredColoring\r\n    // size[0] - w, size[1] - h of rectangle\r\n    var w, h;\r\n    var gap = gap || globalGap * 2; \r\n    \r\n    if (is_vertical) {            \r\n        h = size[1] * amount + gap;\r\n        w = size[0] * 2 + gap;\r\n    }\r\n    else {\r\n        h = size[1] * 2 + gap;\r\n        w = size[0] * amount + gap;\r\n    }    \r\n    return {\r\n        w: w,\r\n        h: h\r\n    }\r\n}\r\n\r\nfunction getTextWidth(description) {\r\n    //check digit in the last string\r\n    var l = 0; //text length\r\n    if (Array.isArray(description)) {\r\n        for (i = 0 ; i < description.length; i++) {\r\n            if (description[i].length > l) {\r\n                l = description[i].length;\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        l = description.length;\r\n    } \r\n    return l*8;\r\n}"]}